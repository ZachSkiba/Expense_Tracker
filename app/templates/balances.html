<!DOCTYPE html>
<html>
<head>
    <title>Roommate Balances</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/balance-styles.css') }}">
</head>
<body>

<h1>Roommate Balances</h1>

<div class="summary-stats">
    <div class="stat-box">
        <div class="stat-number">{{ balances|length }}</div>
        <div>Total Roommates</div>
    </div>
    <div class="stat-box">
        <div class="stat-number">{{ settlements|length }}</div>
        <div>Pending Settlements</div>
    </div>
    <div class="stat-box">
        <div class="stat-number">${{ "%.2f"|format(balances|sum(attribute='balance')|abs) }}</div>
        <div>Total Imbalance</div>
    </div>
</div>



<h2>Current Balances</h2>

{% for balance in balances %}
<div class="balance-card">
    <div>
        <strong>{{ balance.user_name }}</strong>
        {% if balance.last_updated %}
        <small style="color: #666;">(Updated: {{ balance.last_updated[:10] }})</small>
        {% endif %}
    </div>
    <div class="balance-amount">
        {% if balance.balance > 0.01 %}
            <span class="balance-positive">+${{ "%.2f"|format(balance.balance) }}</span>
            <small>(is owed)</small>
        {% elif balance.balance < -0.01 %}
            <span class="balance-negative">-${{ "%.2f"|format(balance.balance|abs) }}</span>
            <small>(owes)</small>
        {% else %}
            <span class="balance-even">$0.00</span>
            <small>(even)</small>
        {% endif %}
    </div>
</div>
{% endfor %}

{% if settlements %}
<h2>ðŸ’° Suggested Settlements</h2>
<p>To settle all debts with minimum transactions:</p>

{% for settlement in settlements %}
<div class="settlement-card">
    <strong>{{ settlement.from }}</strong> should pay <strong>{{ settlement.to }}</strong> 
    <span class="balance-positive">${{ "%.2f"|format(settlement.amount) }}</span>
</div>
{% endfor %}

{% else %}
<h2>ðŸŽ‰ All Settled!</h2>
<p>Everyone is even - no settlements needed!</p>
{% endif %}

<hr>

<h2>Quick Actions</h2>
<a href="{{ url_for('expenses.add_expense') }}">âž• Add New Expense</a><br>
<a href="{{ url_for('expenses.expenses') }}">ðŸ“Š View All Expenses</a><br>
<a href="{{ url_for('manage.management') }}">â¬… Back to Management</a>


</body>
</html>