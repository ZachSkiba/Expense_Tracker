<!DOCTYPE html>
<html>
<head>
    <title>Settings - {{ group.name}}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/settings-page.css') }}">
        
</head>
<body>
    <!-- Header -->
    <div class="header">
        <div class="header-left">
            <h1>‚öôÔ∏è Settings</h1>
        </div>
        <div class="header-center">
            <nav class="header-nav">
                <a href="{{ url_for('expenses.group_tracker', group_id=group.id) }}">üè† Home</a>
                <a href="{{ url_for('expenses.group_expenses', group_id=group.id) }}">üìä View Expenses</a>
                <a href="{{ url_for('balances.combined_balances_settlements', group_id=group.id) }}">üí∞ Balances & Settlements</a>
                <a href="{{ url_for('management.manage_data', group_id=group.id) }}">üõ†Ô∏è Manage Users & Categories</a>
                <a href="{{ url_for('dashboard.home') }}">üè† Dashboard</a>
            </nav>
        </div>
    </div>

    <div class="settings-container">
        <!-- Group Information & Invite Code -->
        <div class="settings-section">
            <div class="section-header" style="display: flex; justify-content: space-between; align-items: center;">
                <h2 class="section-title">{{ group.name }} - Group Information</h2>
                <button id="editToggleBtn" class="edit-toggle-btn" onclick="toggleEditMode()">
                    <span id="editBtnText">‚úèÔ∏è Edit</span>
                </button>
            </div>
            
            <div class="invite-code-item">
                <div class="invite-code-left">
                    <div class="invite-code-icon">üîó</div>
                    <div class="invite-code-info">
                        <div class="invite-code-name">Invite Code</div>
                        <div class="invite-code-description">Share this code with friends to invite them</div>
                    </div>
                </div>
                <div class="invite-code-right">
                    <div class="invite-code-value" id="inviteCode">{{ group.invite_code }}</div>
                    <button class="copy-button" onclick="copyInviteCode()">üìã Copy</button>
                </div>
            </div>
            
            <div class="group-info-item editable-item" data-field="name">
                <span class="group-info-label">Group Name</span>
                <div class="group-info-value-container">
                    <span class="group-info-value editable-value" id="groupName">{{ group.name }}</span>
                    <input type="text" class="group-info-edit hidden" id="groupNameEdit" value="{{ group.name }}" maxlength="100">
                </div>
            </div>
            
            <div class="group-info-item editable-item" data-field="description">
                <span class="group-info-label">Description</span>
                <div class="group-info-value-container">
                    <span class="group-info-value editable-value" id="groupDescription">{{ group.description or 'No description' }}</span>
                    <textarea class="group-info-edit hidden" id="groupDescriptionEdit" maxlength="500" rows="2">{{ group.description or '' }}</textarea>
                </div>
            </div>
            
            <div class="group-info-item">
                <span class="group-info-label">Members</span>
                <span class="group-info-value">{{ group.get_member_count() }} people</span>
            </div>
            
            <div class="group-info-item">
                <span class="group-info-label">Created</span>
                <span class="group-info-value">{{ group.created_at.strftime('%B %d, %Y') }}</span>
            </div>
            
            <div class="group-info-item">
                <span class="group-info-label">Your Role</span>
                <span class="group-info-value">
                    {% if group.creator_id == current_user.id %}
                        Admin (Creator)
                    {% elif current_user.is_group_admin(group) %}
                        Admin
                    {% else %}
                        Member
                    {% endif %}
                </span>
            </div>
        </div>

        <!-- Quick Actions -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Quick Actions</h2>
            </div>

            <a href="{{ url_for('expenses.group_tracker', group_id=group.id) }}" class="setting-item">
                <div class="setting-left">
                    <div class="setting-icon primary">üè†</div>
                    <div class="setting-info">
                        <div class="setting-name">Home</div>
                        <div class="setting-description">Record a shared expense with roommates</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </a>

            <a href="{{ url_for('expenses.group_expenses', group_id=group.id) }}" class="setting-item">
                <div class="setting-left">
                    <div class="setting-icon primary">üìä</div>
                    <div class="setting-info">
                        <div class="setting-name">View All Expenses</div>
                        <div class="setting-description">Browse and filter your expense history</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </a>

            <a href="{{ url_for('balances.combined_balances_settlements', group_id=group.id) }}" class="setting-item">
                <div class="setting-left">
                    <div class="setting-icon success">üí∞</div>
                    <div class="setting-info">
                        <div class="setting-name">Balances & Settlements</div>
                        <div class="setting-description">Log a payment between roommates</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </a>

            <a href="{{ url_for('management.manage_data', group_id=group.id) }}" class="setting-item">
                <div class="setting-left">
                    <div class="setting-icon warning">üõ†Ô∏è</div>
                    <div class="setting-info">
                        <div class="setting-name">Manage Users & Categories</div>
                        <div class="setting-description">Add or remove roommates and expense categories</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </a>
        </div>

        <!-- Appearance -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Appearance</h2>
            </div>
            
            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üåô</div>
                    <div class="setting-info">
                        <div class="setting-name">Dark Mode</div>
                        <div class="setting-description">Switch between light and dark themes</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <div class="toggle-switch disabled"></div>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üé®</div>
                    <div class="setting-info">
                        <div class="setting-name">Theme Color</div>
                        <div class="setting-description">Customize the app's accent color</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-value">Blue</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>
        </div>

        <!-- Data & Privacy -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Data & Privacy</h2>
            </div>
            
            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üì§</div>
                    <div class="setting-info">
                        <div class="setting-name">Export Data</div>
                        <div class="setting-description">Download your expenses as CSV or Excel</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üì•</div>
                    <div class="setting-info">
                        <div class="setting-name">Import Data</div>
                        <div class="setting-description">Import expenses from other apps</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üíæ</div>
                    <div class="setting-info">
                        <div class="setting-name">Backup & Restore</div>
                        <div class="setting-description">Create and restore data backups</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>
        </div>

        <!-- Notifications -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Notifications</h2>
            </div>
            
            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üîî</div>
                    <div class="setting-info">
                        <div class="setting-name">Payment Reminders</div>
                        <div class="setting-description">Get notified when payments are due</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <div class="toggle-switch disabled"></div>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üìß</div>
                    <div class="setting-info">
                        <div class="setting-name">Email Summaries</div>
                        <div class="setting-description">Weekly expense summaries via email</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <div class="toggle-switch disabled"></div>
                </div>
            </div>
        </div>

        <!-- Preferences -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Preferences</h2>
            </div>
            
            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üí±</div>
                    <div class="setting-info">
                        <div class="setting-name">Currency</div>
                        <div class="setting-description">Change the default currency</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-value">USD ($)</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üîÑ</div>
                    <div class="setting-info">
                        <div class="setting-name">Auto-Sync</div>
                        <div class="setting-description">Automatically sync data across devices</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <div class="toggle-switch disabled"></div>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üìä</div>
                    <div class="setting-info">
                        <div class="setting-name">Default View</div>
                        <div class="setting-description">Choose what you see when opening the app</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-value">Home</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>
        </div>

        <!-- Support -->
        <div class="settings-section">
            <div class="section-header">
                <h2 class="section-title">Support</h2>
            </div>
            
            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">‚ùì</div>
                    <div class="setting-info">
                        <div class="setting-name">Help & FAQ</div>
                        <div class="setting-description">Get answers to common questions</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>

            <div class="setting-item disabled">
                <div class="setting-left">
                    <div class="setting-icon">üêõ</div>
                    <div class="setting-info">
                        <div class="setting-name">Report a Bug</div>
                        <div class="setting-description">Help us improve the app</div>
                    </div>
                </div>
                <div class="setting-right">
                    <span class="coming-soon-badge">Coming Soon</span>
                    <span class="setting-arrow">‚Ä∫</span>
                </div>
            </div>
        </div>
    <!-- Delete Group Section (Admin Only) -->
            {% if group.creator_id == current_user.id or current_user.is_group_admin(group) %}
            <div class="danger-zone-section">
                <div class="danger-zone-header">
                    <h3 class="danger-zone-title">‚ö†Ô∏è Danger Zone</h3>
                </div>
                
                <div class="delete-group-item">
                    <div class="delete-group-left">
                        <div class="delete-group-icon">üóëÔ∏è</div>
                        <div class="delete-group-info">
                            <div class="delete-group-name">Delete Group</div>
                            <div class="delete-group-description">
                                Permanently delete this group and all associated data. This action cannot be undone.
                            </div>
                        </div>
                    </div>
                    <div class="delete-group-right">
                        <button class="delete-group-button" onclick="showDeleteConfirmation()">
                            üóëÔ∏è Delete Group
                        </button>
                    </div>
                </div>
            </div>
            {% endif %}
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteConfirmationModal" class="modal-overlay" style="display: none;">
        <div class="modal-content delete-modal">
            <div class="modal-header">
                <h2 class="modal-title">üóëÔ∏è Delete Group</h2>
            </div>
            
            <div class="modal-body">
                <div class="warning-message">
                    <div class="warning-icon">‚ö†Ô∏è</div>
                    <div class="warning-text">
                        <strong>This action cannot be undone!</strong><br>
                        This will permanently delete the group "{{ group.name }}" and all associated:
                        <ul>
                            <li>Expenses and transactions</li>
                            <li>Balances and settlements</li>
                            <li>Categories and member data</li>
                            <li>All group history</li>
                        </ul>
                    </div>
                </div>
                
                <div class="confirmation-input">
                    <label for="deleteConfirmation">Type <strong>"delete"</strong> to confirm:</label>
                    <input type="text" id="deleteConfirmation" placeholder="Type 'delete' here" autocomplete="off">
                </div>
            </div>
            
            <div class="modal-footer">
                <button class="modal-btn modal-btn-cancel" onclick="hideDeleteConfirmation()">
                    Cancel
                </button>
                <button class="modal-btn modal-btn-delete" id="confirmDeleteBtn" onclick="confirmDeleteGroup()" disabled>
                    üóëÔ∏è Delete Group Forever
                </button>
            </div>
        </div>
    </div>

    <script>
      window.groupId = "{{ group.id }}";
      window.groupName = "{{ group.name }}";
    </script>
    <!-- Include settings JavaScript module -->
    <script src="{{ url_for('static', filename='js/modules/settings.js') }}"></script>
</body>
</html>